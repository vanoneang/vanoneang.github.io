<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTP协议原理 | Evan&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/logo.png">
    <script src="https://www.googletagmanager.com/gtag/js?id=G-PHEXM93QFE" async="true"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
      
        gtag('config', 'G-PHEXM93QFE');
      </script>
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.41f50347.css" as="style"><link rel="preload" href="/assets/js/app.a558ac5a.js" as="script"><link rel="preload" href="/assets/js/10.58d1b88a.js" as="script"><link rel="preload" href="/assets/js/2.7fe25666.js" as="script"><link rel="preload" href="/assets/js/1.8980b9bc.js" as="script"><link rel="preload" href="/assets/js/47.5ca31691.js" as="script"><link rel="preload" href="/assets/js/5.180fde47.js" as="script"><link rel="prefetch" href="/assets/js/11.7480e672.js"><link rel="prefetch" href="/assets/js/14.77e4d103.js"><link rel="prefetch" href="/assets/js/15.767347da.js"><link rel="prefetch" href="/assets/js/16.75837ee9.js"><link rel="prefetch" href="/assets/js/17.8b42675a.js"><link rel="prefetch" href="/assets/js/18.83de754f.js"><link rel="prefetch" href="/assets/js/19.64c1babe.js"><link rel="prefetch" href="/assets/js/20.eb3c9bfd.js"><link rel="prefetch" href="/assets/js/21.0ac73fe5.js"><link rel="prefetch" href="/assets/js/22.440e982a.js"><link rel="prefetch" href="/assets/js/23.14b7ea1e.js"><link rel="prefetch" href="/assets/js/24.2cc19a77.js"><link rel="prefetch" href="/assets/js/25.5a1af9bd.js"><link rel="prefetch" href="/assets/js/26.1dbf73a6.js"><link rel="prefetch" href="/assets/js/27.f35d0d7a.js"><link rel="prefetch" href="/assets/js/28.d3b1bd05.js"><link rel="prefetch" href="/assets/js/29.156c7c28.js"><link rel="prefetch" href="/assets/js/3.b2e8d6d0.js"><link rel="prefetch" href="/assets/js/30.d0ef52da.js"><link rel="prefetch" href="/assets/js/31.3141c712.js"><link rel="prefetch" href="/assets/js/32.fb2a7e01.js"><link rel="prefetch" href="/assets/js/33.60948b59.js"><link rel="prefetch" href="/assets/js/34.f7619399.js"><link rel="prefetch" href="/assets/js/35.6490ea95.js"><link rel="prefetch" href="/assets/js/36.a2c30aa4.js"><link rel="prefetch" href="/assets/js/37.4c4f8de0.js"><link rel="prefetch" href="/assets/js/38.1230e082.js"><link rel="prefetch" href="/assets/js/39.618e2b6e.js"><link rel="prefetch" href="/assets/js/4.7883f2b1.js"><link rel="prefetch" href="/assets/js/40.bc7d5fd1.js"><link rel="prefetch" href="/assets/js/41.f9f2f594.js"><link rel="prefetch" href="/assets/js/42.7a8c93b6.js"><link rel="prefetch" href="/assets/js/43.ff58b174.js"><link rel="prefetch" href="/assets/js/44.4cb3b30c.js"><link rel="prefetch" href="/assets/js/45.f15b11c7.js"><link rel="prefetch" href="/assets/js/46.80e4a51b.js"><link rel="prefetch" href="/assets/js/48.5d192a8f.js"><link rel="prefetch" href="/assets/js/49.52310326.js"><link rel="prefetch" href="/assets/js/50.82d6e2db.js"><link rel="prefetch" href="/assets/js/51.d0bb03e0.js"><link rel="prefetch" href="/assets/js/52.bf0b3ca2.js"><link rel="prefetch" href="/assets/js/53.26741547.js"><link rel="prefetch" href="/assets/js/54.4d74c40c.js"><link rel="prefetch" href="/assets/js/55.2cc4e873.js"><link rel="prefetch" href="/assets/js/56.bb2e229a.js"><link rel="prefetch" href="/assets/js/57.52f6ff68.js"><link rel="prefetch" href="/assets/js/58.76d668cd.js"><link rel="prefetch" href="/assets/js/59.b03dda21.js"><link rel="prefetch" href="/assets/js/6.df748d3e.js"><link rel="prefetch" href="/assets/js/60.099a8d24.js"><link rel="prefetch" href="/assets/js/61.d3ea715f.js"><link rel="prefetch" href="/assets/js/62.56b719bf.js"><link rel="prefetch" href="/assets/js/63.5c213900.js"><link rel="prefetch" href="/assets/js/64.47676a52.js"><link rel="prefetch" href="/assets/js/65.e609f20c.js"><link rel="prefetch" href="/assets/js/66.6acc82e5.js"><link rel="prefetch" href="/assets/js/67.faf9a8ab.js"><link rel="prefetch" href="/assets/js/68.17c0704e.js"><link rel="prefetch" href="/assets/js/69.cd839ad6.js"><link rel="prefetch" href="/assets/js/7.d03bf257.js"><link rel="prefetch" href="/assets/js/70.f6ce40f5.js"><link rel="prefetch" href="/assets/js/71.f016426d.js"><link rel="prefetch" href="/assets/js/72.83b722de.js"><link rel="prefetch" href="/assets/js/73.4adccae9.js"><link rel="prefetch" href="/assets/js/74.1adc8aa0.js"><link rel="prefetch" href="/assets/js/75.e46164a6.js"><link rel="prefetch" href="/assets/js/76.8b5875a4.js"><link rel="prefetch" href="/assets/js/77.92eae67e.js"><link rel="prefetch" href="/assets/js/78.4cb6e049.js"><link rel="prefetch" href="/assets/js/79.03859c97.js"><link rel="prefetch" href="/assets/js/8.ecffb889.js"><link rel="prefetch" href="/assets/js/80.1288e8f0.js"><link rel="prefetch" href="/assets/js/81.d8841b36.js"><link rel="prefetch" href="/assets/js/82.e50feb3f.js"><link rel="prefetch" href="/assets/js/83.4553329a.js"><link rel="prefetch" href="/assets/js/84.faca13fe.js"><link rel="prefetch" href="/assets/js/85.cda6f0d0.js"><link rel="prefetch" href="/assets/js/86.4b93d23e.js"><link rel="prefetch" href="/assets/js/87.84ce55e8.js"><link rel="prefetch" href="/assets/js/88.651a4fd5.js"><link rel="prefetch" href="/assets/js/89.e8aa0f21.js"><link rel="prefetch" href="/assets/js/9.7babaa2e.js"><link rel="prefetch" href="/assets/js/90.d189b2da.js"><link rel="prefetch" href="/assets/js/91.befac5d7.js"><link rel="prefetch" href="/assets/js/92.3825ad82.js"><link rel="prefetch" href="/assets/js/93.b229e59f.js"><link rel="prefetch" href="/assets/js/94.703fe491.js"><link rel="prefetch" href="/assets/js/95.299fd1b4.js"><link rel="prefetch" href="/assets/js/96.dd1e2aab.js"><link rel="prefetch" href="/assets/js/97.b0c53a50.js"><link rel="prefetch" href="/assets/js/98.9eed6020.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.719578e8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.41f50347.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/left-logo.png" alt="Evan's Blog" class="logo"> <span class="site-name can-hide">Evan's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/frontend/" class="nav-link router-link-active">
  大前端
</a></div><div class="nav-item"><a href="/devops/" class="nav-link">
  运维
</a></div><div class="nav-item"><a href="/article/" class="nav-link">
  Article
</a></div><div class="nav-item"><a href="/english/" class="nav-link">
  English learning
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/vanoneang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/frontend/" class="nav-link router-link-active">
  大前端
</a></div><div class="nav-item"><a href="/devops/" class="nav-link">
  运维
</a></div><div class="nav-item"><a href="/article/" class="nav-link">
  Article
</a></div><div class="nav-item"><a href="/english/" class="nav-link">
  English learning
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/vanoneang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/js/copy.html" class="sidebar-link">深浅拷贝</a></li><li><a href="/frontend/js/basic-knowledge.html" class="sidebar-link">JS基础知识</a></li><li><a href="/frontend/js/senior-knowledge.html" class="sidebar-link">JS高级知识</a></li><li><a href="/frontend/js/http.html" aria-current="page" class="active sidebar-link">HTTP协议原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/js/http.html#_1、http发展历史" class="sidebar-link">1、HTTP发展历史</a></li><li class="sidebar-sub-header"><a href="/frontend/js/http.html#_2、osi七层模型" class="sidebar-link">2、OSI七层模型</a></li><li class="sidebar-sub-header"><a href="/frontend/js/http.html#_3、http的三次握手" class="sidebar-link">3、HTTP的三次握手</a></li><li class="sidebar-sub-header"><a href="/frontend/js/http.html#_4、http-1-1中的状态码" class="sidebar-link">4、HTTP/1.1中的状态码</a></li><li class="sidebar-sub-header"><a href="/frontend/js/http.html#_5-http协议常见请求-响应头" class="sidebar-link">5. HTTP协议常见请求/响应头</a></li><li class="sidebar-sub-header"><a href="/frontend/js/http.html#_6-http协议的工作特点和工作原理" class="sidebar-link">6. HTTP协议的工作特点和工作原理</a></li><li class="sidebar-sub-header"><a href="/frontend/js/http.html#_7-cors跨域请求" class="sidebar-link">7. CORS跨域请求</a></li><li class="sidebar-sub-header"><a href="/frontend/js/http.html#_8-cookie和session" class="sidebar-link">8. Cookie和Session</a></li><li class="sidebar-sub-header"><a href="/frontend/js/http.html#redirect" class="sidebar-link">Redirect</a></li></ul></li><li><a href="/frontend/js/vue.html" class="sidebar-link">Vue源码理解</a></li><li><a href="/frontend/js/react.html" class="sidebar-link">React</a></li><li><a href="/frontend/js/vue-jsonp.html" class="sidebar-link">Vue中jsonp</a></li><li><a href="/frontend/js/webpack.html" class="sidebar-link">Webpack</a></li><li><a href="/frontend/js/OAuth2.0.html" class="sidebar-link">OAuth（开放式授权）</a></li><li><a href="/frontend/js/apply-call-bind.html" class="sidebar-link">apply、call、bind</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NodeJS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Other</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="http协议原理"><a href="#http协议原理" class="header-anchor">#</a> HTTP协议原理</h1> <p>本文介绍 HTTP 的协议原理，会详细分析跨域的具体原理及其解决方案，后续将持续更新 HTTP2、HTTP3 的最新知识。</p> <h2 id="_1、http发展历史"><a href="#_1、http发展历史" class="header-anchor">#</a> 1、HTTP发展历史</h2> <p>HTTP 协议版本大致分为以下四个演进版本。</p> <img src="data:image/jpeg;base64,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"> <ol><li><strong>HTTP/0.9</strong></li></ol> <ul><li>只有一个命令GET</li> <li>没有HEADER等描述数据的信息</li> <li>服务器发送完毕，就关闭TCP连接</li></ul> <ol start="2"><li><strong>HTTP/1.0</strong></li></ol> <ul><li>增加了很多命令（POST/PUT等）</li> <li>增加status code和header</li> <li>多字符集支持、多部分发送、权限、缓存等</li></ul> <ol start="3"><li><strong>HTTP/1.1</strong></li></ol> <ul><li>持久连接</li> <li>pipeline在同一个连接里发送多个请求</li> <li>增加host（同一个物理服务器可以跑多个web服务）和其他一些命令</li></ul> <ol start="4"><li><strong>HTTP2</strong></li></ol> <ul><li>所有数据以二进制传输（之前是字符串）</li> <li>同一个连接里面发送多个请求不再需要按照顺序来，可以同时多个请求数据</li> <li>头信息压缩（减少带宽使用）以及推送等提高效率的功能（服务端可以主动发起传输）</li></ul> <h2 id="_2、osi七层模型"><a href="#_2、osi七层模型" class="header-anchor">#</a> 2、OSI七层模型</h2> <img src="/assets/TCPIP.png"> <p>OSI模型是在协议开发前设计的，具有通用性。TCP/IP是先有协议集然后建立模型，不适用于非TCP/IP网络。</p> <ol><li><strong>物理层</strong></li></ol> <p>建立、维护、断开物理连接(定义物理设备如何传输数据)</p> <ol start="2"><li><strong>数据链路层</strong></li></ol> <p>建立逻辑连接、进行硬件地址寻址、差错校验等功能（通信的实体之间建立数据链路连接：0101之类的）</p> <ol start="3"><li><strong>网络层</strong></li></ol> <p>进行逻辑寻址，实现不同网络之间的路径选择（为数据在结点之间传输创建逻辑链路）</p> <ol start="4"><li><strong>传输层</strong></li></ol> <p>定义传输数据的协议端口号，以及流控和差错校验</p> <p>协议有TCP(传输控制协议)和UDP（用户数据报协议，不可靠），数据包一旦离开网卡即进入网络传输层，向用户提供可靠的端到端（End-to-End）服务</p> <ol start="5"><li><strong>会话层</strong></li></ol> <p>建立、管理、终止会话。</p> <ol start="6"><li><strong>表示层</strong></li></ol> <p>数据的表示、安全和压缩。</p> <ol start="7"><li><strong>应用层</strong></li></ol> <p>网络服务与最终用户的一个接口;
为应用软件提供了很多服务；
构建于TCP协议之上；
屏蔽网络传输相关细节</p> <p>协议有HTTP/FTP/SMTP/DNS/HTTPS/POP3</p> <h2 id="_3、http的三次握手"><a href="#_3、http的三次握手" class="header-anchor">#</a> 3、HTTP的三次握手</h2> <p>首先，HTTP是不存在<code>连接</code>这么个概念的，只有<code>请求</code>和<code>响应</code>这个概念，都是数据包，那么这时候就需要一个传输的通道了，这个通道在哪里呢？就在TCP里了，在完成了三次握手之后，创建一个<code>TCP connection</code>,我们的http请求是在这个连接的基础上发送的。三次握手主要是为了规避网络传输中延迟导致的一些服务器开销问题。</p> <p>在<code>TCP connection</code>上面是可以发送多个请求的。</p> <p><strong>URI(统一资源标识符)</strong>：用来唯一标识互联网上的信息资源，包含URL（统一资源定位器）和URN(永久统一资源定位符：在资源被移动后还能找到)。</p> <p><strong>长链接</strong>: Chrome的并发限制是6条，当一个页面有6个以上的请求发送时，会创建6个长链接<code>TCP connection</code>，在控制面板<code>network</code>的<code>Waterfall</code>中可以看出。</p> <p>如果一个页面中有很多图片，下面的往往加载很慢，就是因为并发只有6个，后面的需要等待前面的执行完毕。同时，会复用前面的TCP连接<code>Connection: keep-alive</code></p> <h2 id="_4、http-1-1中的状态码"><a href="#_4、http-1-1中的状态码" class="header-anchor">#</a> 4、HTTP/1.1中的状态码</h2> <img src="/assets/img/http1.b9751887.png"> <ul><li><strong>200</strong> OK 正确处理</li> <li><strong>201</strong> CREATED 新建或更新数据成功。</li> <li><strong>204</strong> NO CONTENT 服务器接收的请求已成功处理，在返回的报文中不含主体的实体响应部分</li> <li><strong>301</strong> 永久性重定向</li> <li><strong>302</strong> 临时性重定向</li> <li><strong>304</strong> Not Modified 服务端资源维修改，从前端浏览器读取缓存</li> <li><strong>400</strong> BAD REQUEST 用户发出的请求有错误，该请求是幂等的。</li> <li><strong>401</strong> Unauthorized 表示用户没有认证，无法进行当前操作。比如，登录需要账号密码，只提供账号，没有密码，返回422</li> <li><strong>403</strong> Forbidden 由于服务端策略，当前资源被禁止访问</li> <li><strong>404</strong> Not Found 服务端没有找到请求的资源</li> <li><strong>499</strong> Client Aborted 这是Nginx对status的一个扩展，不产生实际响应，只记录在Nginx日志中。</li> <li><strong>500</strong> INTERNAL SERVER ERROR - [*]：服务器发生错误，用户将无法判断发出的请求是否成功。</li> <li><strong>502</strong> Bad Gateway 当Web server充当proxy角色时，无法连接到上游服务</li> <li><strong>503</strong> Service Unavailable 服务器正在超负载，或者正在进行停机维护</li> <li><strong>504</strong> Gateway Timeout 当Web server充当proxy角色时，上游服务响应超时</li></ul> <blockquote><p>502/504的对比，502表示与upstream在TCP层就无法连接,而504则是确定在应用层建立了连接,由于upstream的响应时间大于proxy的timeout阈值</p></blockquote> <h2 id="_5-http协议常见请求-响应头"><a href="#_5-http协议常见请求-响应头" class="header-anchor">#</a> 5. HTTP协议常见请求/响应头</h2> <p>通过 <code>curl -v</code> 可以得到 HTTP 请求的完整报文。</p> <ul><li>Content-Type:请求的与实体对应的 MIME 信息</li> <li>Accept：指定客户端能接受的内容类型</li> <li>Origin：最初的请求来源于哪儿，主要用于POST请求</li></ul> <p>origin的提出，本身就是在HTML5中跨域操作所引入的。
其具体流程是，当一个链接或者XMLHttpRequest去请求跨域操作，浏览器事实上的确向目标服务器发起了连接请求，并且携带这origin。
当服务器返回时，浏览器将检查response中是否包含Access-Control-Allow-Origin字段，当缺少这个字段时，浏览器将abort，abort的意思是不显示，不产生事件，就好像没有请求过，甚至在network区域里面都看不到。
当存在这个header时，浏览器将检查当前请求所在域是否在这个access-control-allow-origin所允许的域内，如果是，继续下去，如果不存在，abort！</p> <ul><li><p>Cookie：发送给服务端的cookie的值</p></li> <li><p>Cache-Control：指定缓存响应机制（public/private/no-cache）</p> <p>private是指，只允许发送请求的域名进行缓存，其他代理的不允许</p></li> <li><p>User-Agent：用户信息</p></li> <li><p>X-Forwarded-For：请求端真实的IP</p></li> <li><p>Access-Control-Allow-Origin：允许特定的域名来访问（跨域使用）</p></li> <li><p>Last-Modified：请求资源的最后响应时间，在服务端设置后，对应的在<code>Request Headers</code>中，会携带<code>If-Modified-Since</code>头</p></li> <li><p>Etag：通过数据签名，进行是否缓存验证，在服务端设置后，对应的在<code>Request Headers</code>中，会携带<code>If-None-Match</code>头</p></li> <li><p>Connection: 通知浏览器保持当前HTTP连接，以便在策略允许范围内进行连接复用</p></li> <li><p>Keep-Alive: 保持连接的策略</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> etag <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'if-none-match'</span><span class="token punctuation">]</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>etag <span class="token operator">===</span> <span class="token string">'etag'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">304</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'Cache-Control'</span><span class="token operator">:</span> <span class="token string">'max-age=2000, no-cache'</span><span class="token punctuation">,</span>
    <span class="token string-property property">'Last-Modified'</span><span class="token operator">:</span> reqTime<span class="token punctuation">,</span>
    <span class="token string-property property">'Etag'</span><span class="token operator">:</span> <span class="token string">'etag'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> 
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'Cache-Control'</span><span class="token operator">:</span> <span class="token string">'max-age=2000, no-cache'</span><span class="token punctuation">,</span>
    <span class="token string-property property">'Last-Modified'</span><span class="token operator">:</span> reqTime<span class="token punctuation">,</span>
    <span class="token string-property property">'Etag'</span><span class="token operator">:</span> <span class="token string">'etag'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'res ok!'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="_6-http协议的工作特点和工作原理"><a href="#_6-http协议的工作特点和工作原理" class="header-anchor">#</a> 6. HTTP协议的工作特点和工作原理</h2> <p><strong>工作特点</strong></p> <ul><li><p>基于B/S模式</p></li> <li><p>通信开销小，简单快速，传输成本底</p></li> <li><p>使用灵活、可使用超文本传输协议</p></li> <li><p>节省传输时间</p></li> <li><p>无状态</p></li></ul> <p><strong>工作原理</strong></p> <p>客户端发送请求到服务器，创建一个TCP连接，指定端口号，默认为80，连接到服务器，服务器监听浏览器请求，一旦监听到客户端请求，分析请求类型后，服务器会向客户端返回状态信息和数据内容。</p> <h2 id="_7-cors跨域请求"><a href="#_7-cors跨域请求" class="header-anchor">#</a> 7. CORS跨域请求</h2> <h3 id="_7-1-浏览器同域限制"><a href="#_7-1-浏览器同域限制" class="header-anchor">#</a> 7.1 浏览器同域限制</h3> <p>如果服务端没有设置头信息 <code>Access-Control-Allow-Origin</code>，在前端跨域请求时，虽然客户端的请求还会被服务端正常接收，但是浏览器会把服务端返回的数据忽略掉，并在console中报错，这是<strong>浏览器的同源策略</strong>。</p> <p>一种解决方案是允许特定的请求域名：</p> <div class="language-js extra-class"><pre class="language-js"><code>  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> <span class="token string">&quot;http://127.0.0.1:8888&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>但要注意，<strong>非浏览器环境是没有同域限制的</strong>，比如通过 <code>curl</code> 来获取数据，从 <code>8888</code> 端口向 <code>8887</code> 端口获取数据，是可以正常通信的。</p> <div class="language- extra-class"><pre class="language-text"><code>---&gt; curl 127.0.0.1:8887

&lt;--- 123
</code></pre></div><p>另外，可以通过 <code>jsonp</code> 来实现跨域请求，其原理就是 <code>script</code> 标签没有同源限制，具体实现参考 <a href="/frontend/js/vue-jsonp.html">Vue中的jsonp</a>。另外需要知道JSONP只支持GET请求。</p> <h3 id="_7-2-预请求"><a href="#_7-2-预请求" class="header-anchor">#</a> 7.2 预请求</h3> <p>浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not-so-simple request）。只要同时满足以下两大条件，就属于简单请求。</p> <p>（1) 请求方法是以下三种方法之一：</p> <ul><li>HEAD</li> <li>GET</li> <li>POST</li></ul> <p>（2）HTTP的头信息不超出以下几种字段：</p> <ul><li>Accept</li> <li>Accept-Language</li> <li>Content-Language</li> <li>Last-Event-ID</li> <li>Content-Type：只限于三个值application/x-www-form-urlencoded、multipart/form-data、text/plain</li></ul> <p>对于简单请求，浏览器直接发出CORS请求。具体来说，就是在头信息之中，增加一个Origin字段。我们日常开发过程中，总是会先进行一次预请求主要就是因为 <code>Content-Type</code> 的值被设置为了 <code>application/json;charset=UTF-8</code>。</p> <p>比如：</p> <div class="language- extra-class"><pre class="language-text"><code>GET /cors HTTP/1.1
Origin: http://www.baidu.com
Host: http:localhost:8888
Accept-Language: en-US
Connection: keep-alive
User-Agent: Mozilla/5.0
</code></pre></div><p>上面的头信息中，<code>Origin</code> 字段用来说明，本次请求来自哪个源（协议 + 域名 + 端口）。服务器根据这个值，决定是否同意这次请求。非简单请求的 <code>CORS</code> 请求，会在正式通信之前，增加一次 <code>HTTP</code> 查询请求，称为&quot;预检&quot;请求（preflight）。</p> <p>非简单请求是那种对服务器有特殊要求的请求，比如请求方法是 <code>PUT</code> 或 <code>DELETE</code>，或者 <code>Content-Type</code> 字段的类型是 <code>application/json</code>。</p> <p>除了 Origin 字段也就是 <code>Access-Control-Allow-Origin</code> 外，预请求的头信息包括两个特殊字段。</p> <p>（1）Access-Control-Request-Method</p> <p>该字段是必须的，用来列出浏览器的CORS请求会用到哪些HTTP方法，比如 <code>PUT</code>。</p> <p>（2）Access-Control-Request-Headers</p> <p>该字段是一个逗号分隔的字符串，指定浏览器CORS请求会额外发送的头信息字段，比如 <code>X-Custom-Header</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>origin <span class="token operator">==</span> <span class="token string">'https://www.google.com'</span> <span class="token operator">||</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>origin <span class="token operator">==</span> <span class="token string">'https://www.baidu.com'</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Methods'</span><span class="token punctuation">,</span> <span class="token string">'POST, GET'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Headers'</span><span class="token punctuation">,</span> <span class="token string">'X-Requested-With'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Headers'</span><span class="token punctuation">,</span> <span class="token string">'Content-Type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Max-Age'</span><span class="token punctuation">,</span> <span class="token string">'1000'</span><span class="token punctuation">)</span> <span class="token comment">// 在这个时间段内，只需要一次预请求</span>
    <span class="token punctuation">}</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_8-cookie和session"><a href="#_8-cookie和session" class="header-anchor">#</a> 8. Cookie和Session</h2> <p><strong>cookie</strong></p> <ul><li>通过Set-Cookie设置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> html <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'test.html'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span><span class="token punctuation">,</span>
    <span class="token string-property property">'Set-Cookie'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'id=123; max-age=600'</span><span class="token punctuation">,</span><span class="token string">'name=evan; HttpOnly'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>下次请求会自动带上</li> <li>键值对，可以设置多个</li></ul> <p><strong>cookie的属性</strong></p> <ul><li>max-age和expire设置过期时间</li> <li>Secure只在https的时候发送</li> <li>HttpOnly: 禁止 JavaScript 通过 document.cookie 访问</li></ul> <h2 id="redirect"><a href="#redirect" class="header-anchor">#</a> Redirect</h2> <div class="language-js extra-class"><pre class="language-js"><code>http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">302</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  <span class="token comment">// 302 临时跳转，每次都经过'/'  301 永久重定向（慎用）</span>
      <span class="token string-property property">'Location'</span><span class="token operator">:</span> <span class="token string">'/newroute'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">'/newroute'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'&lt;div&gt;this is redirect content&lt;/div&gt;'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div data-v-244f5c7a><ul class="rightMenuWrapper" data-v-244f5c7a></ul></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frontend/js/senior-knowledge.html" class="prev">
        JS高级知识
      </a></span> <span class="next"><a href="/frontend/js/vue.html">
        Vue源码理解
      </a>
      →
    </span></p></div> <img src="/assets/img/bottom-logo.385a53c5.png" style="position:absolute;width:135px;left:calc(100% / 2 + 50px);transform:translateX(-50%);"></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a558ac5a.js" defer></script><script src="/assets/js/10.58d1b88a.js" defer></script><script src="/assets/js/2.7fe25666.js" defer></script><script src="/assets/js/1.8980b9bc.js" defer></script><script src="/assets/js/47.5ca31691.js" defer></script><script src="/assets/js/5.180fde47.js" defer></script>
  </body>
</html>
