<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Understanding setImmediate() | Evan&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/logo.png">
    <script src="https://www.googletagmanager.com/gtag/js?id=G-PHEXM93QFE" async="true"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
      
        gtag('config', 'G-PHEXM93QFE');
      </script>
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.41f50347.css" as="style"><link rel="preload" href="/assets/js/app.a558ac5a.js" as="script"><link rel="preload" href="/assets/js/10.58d1b88a.js" as="script"><link rel="preload" href="/assets/js/2.7fe25666.js" as="script"><link rel="preload" href="/assets/js/1.8980b9bc.js" as="script"><link rel="preload" href="/assets/js/48.5d192a8f.js" as="script"><link rel="prefetch" href="/assets/js/11.7480e672.js"><link rel="prefetch" href="/assets/js/14.77e4d103.js"><link rel="prefetch" href="/assets/js/15.767347da.js"><link rel="prefetch" href="/assets/js/16.75837ee9.js"><link rel="prefetch" href="/assets/js/17.8b42675a.js"><link rel="prefetch" href="/assets/js/18.83de754f.js"><link rel="prefetch" href="/assets/js/19.64c1babe.js"><link rel="prefetch" href="/assets/js/20.eb3c9bfd.js"><link rel="prefetch" href="/assets/js/21.0ac73fe5.js"><link rel="prefetch" href="/assets/js/22.440e982a.js"><link rel="prefetch" href="/assets/js/23.14b7ea1e.js"><link rel="prefetch" href="/assets/js/24.2cc19a77.js"><link rel="prefetch" href="/assets/js/25.5a1af9bd.js"><link rel="prefetch" href="/assets/js/26.1dbf73a6.js"><link rel="prefetch" href="/assets/js/27.f35d0d7a.js"><link rel="prefetch" href="/assets/js/28.d3b1bd05.js"><link rel="prefetch" href="/assets/js/29.156c7c28.js"><link rel="prefetch" href="/assets/js/3.b2e8d6d0.js"><link rel="prefetch" href="/assets/js/30.d0ef52da.js"><link rel="prefetch" href="/assets/js/31.3141c712.js"><link rel="prefetch" href="/assets/js/32.fb2a7e01.js"><link rel="prefetch" href="/assets/js/33.60948b59.js"><link rel="prefetch" href="/assets/js/34.f7619399.js"><link rel="prefetch" href="/assets/js/35.6490ea95.js"><link rel="prefetch" href="/assets/js/36.a2c30aa4.js"><link rel="prefetch" href="/assets/js/37.4c4f8de0.js"><link rel="prefetch" href="/assets/js/38.1230e082.js"><link rel="prefetch" href="/assets/js/39.618e2b6e.js"><link rel="prefetch" href="/assets/js/4.7883f2b1.js"><link rel="prefetch" href="/assets/js/40.bc7d5fd1.js"><link rel="prefetch" href="/assets/js/41.f9f2f594.js"><link rel="prefetch" href="/assets/js/42.7a8c93b6.js"><link rel="prefetch" href="/assets/js/43.ff58b174.js"><link rel="prefetch" href="/assets/js/44.4cb3b30c.js"><link rel="prefetch" href="/assets/js/45.f15b11c7.js"><link rel="prefetch" href="/assets/js/46.80e4a51b.js"><link rel="prefetch" href="/assets/js/47.5ca31691.js"><link rel="prefetch" href="/assets/js/49.52310326.js"><link rel="prefetch" href="/assets/js/5.180fde47.js"><link rel="prefetch" href="/assets/js/50.82d6e2db.js"><link rel="prefetch" href="/assets/js/51.d0bb03e0.js"><link rel="prefetch" href="/assets/js/52.bf0b3ca2.js"><link rel="prefetch" href="/assets/js/53.26741547.js"><link rel="prefetch" href="/assets/js/54.4d74c40c.js"><link rel="prefetch" href="/assets/js/55.2cc4e873.js"><link rel="prefetch" href="/assets/js/56.bb2e229a.js"><link rel="prefetch" href="/assets/js/57.52f6ff68.js"><link rel="prefetch" href="/assets/js/58.76d668cd.js"><link rel="prefetch" href="/assets/js/59.b03dda21.js"><link rel="prefetch" href="/assets/js/6.df748d3e.js"><link rel="prefetch" href="/assets/js/60.099a8d24.js"><link rel="prefetch" href="/assets/js/61.d3ea715f.js"><link rel="prefetch" href="/assets/js/62.56b719bf.js"><link rel="prefetch" href="/assets/js/63.5c213900.js"><link rel="prefetch" href="/assets/js/64.47676a52.js"><link rel="prefetch" href="/assets/js/65.e609f20c.js"><link rel="prefetch" href="/assets/js/66.6acc82e5.js"><link rel="prefetch" href="/assets/js/67.faf9a8ab.js"><link rel="prefetch" href="/assets/js/68.17c0704e.js"><link rel="prefetch" href="/assets/js/69.cd839ad6.js"><link rel="prefetch" href="/assets/js/7.d03bf257.js"><link rel="prefetch" href="/assets/js/70.f6ce40f5.js"><link rel="prefetch" href="/assets/js/71.f016426d.js"><link rel="prefetch" href="/assets/js/72.83b722de.js"><link rel="prefetch" href="/assets/js/73.4adccae9.js"><link rel="prefetch" href="/assets/js/74.1adc8aa0.js"><link rel="prefetch" href="/assets/js/75.e46164a6.js"><link rel="prefetch" href="/assets/js/76.8b5875a4.js"><link rel="prefetch" href="/assets/js/77.92eae67e.js"><link rel="prefetch" href="/assets/js/78.4cb6e049.js"><link rel="prefetch" href="/assets/js/79.03859c97.js"><link rel="prefetch" href="/assets/js/8.ecffb889.js"><link rel="prefetch" href="/assets/js/80.1288e8f0.js"><link rel="prefetch" href="/assets/js/81.d8841b36.js"><link rel="prefetch" href="/assets/js/82.e50feb3f.js"><link rel="prefetch" href="/assets/js/83.4553329a.js"><link rel="prefetch" href="/assets/js/84.faca13fe.js"><link rel="prefetch" href="/assets/js/85.cda6f0d0.js"><link rel="prefetch" href="/assets/js/86.4b93d23e.js"><link rel="prefetch" href="/assets/js/87.84ce55e8.js"><link rel="prefetch" href="/assets/js/88.651a4fd5.js"><link rel="prefetch" href="/assets/js/89.e8aa0f21.js"><link rel="prefetch" href="/assets/js/9.7babaa2e.js"><link rel="prefetch" href="/assets/js/90.d189b2da.js"><link rel="prefetch" href="/assets/js/91.befac5d7.js"><link rel="prefetch" href="/assets/js/92.3825ad82.js"><link rel="prefetch" href="/assets/js/93.b229e59f.js"><link rel="prefetch" href="/assets/js/94.703fe491.js"><link rel="prefetch" href="/assets/js/95.299fd1b4.js"><link rel="prefetch" href="/assets/js/96.dd1e2aab.js"><link rel="prefetch" href="/assets/js/97.b0c53a50.js"><link rel="prefetch" href="/assets/js/98.9eed6020.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.719578e8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.41f50347.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/left-logo.png" alt="Evan's Blog" class="logo"> <span class="site-name can-hide">Evan's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/frontend/" class="nav-link router-link-active">
  大前端
</a></div><div class="nav-item"><a href="/devops/" class="nav-link">
  运维
</a></div><div class="nav-item"><a href="/article/" class="nav-link">
  Article
</a></div><div class="nav-item"><a href="/english/" class="nav-link">
  English learning
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/vanoneang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/frontend/" class="nav-link router-link-active">
  大前端
</a></div><div class="nav-item"><a href="/devops/" class="nav-link">
  运维
</a></div><div class="nav-item"><a href="/article/" class="nav-link">
  Article
</a></div><div class="nav-item"><a href="/english/" class="nav-link">
  English learning
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/vanoneang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>NodeJS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/node/basis.html" class="sidebar-link">基础知识</a></li><li><a href="/frontend/node/koa.html" class="sidebar-link">koa</a></li><li><a href="/frontend/node/set-immediate.html" aria-current="page" class="active sidebar-link">Understanding setImmediate()</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/node/set-immediate.html#event-loop" class="sidebar-link">Event Loop</a></li><li class="sidebar-sub-header"><a href="/frontend/node/set-immediate.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Other</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="understanding-setimmediate"><a href="#understanding-setimmediate" class="header-anchor">#</a> Understanding setImmediate()</h1> <p>The Node.js setImmediate function interacts with the event loop in a special way.</p> <p>When you want to execute some piece of code asynchronously, but as soon as possible, one option is to use the <code>setImmediate()</code> function provided by Node.js:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//run something</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Any function passed as the setImmediate() argument is a callback that’s executed in the next iteration of the event loop.</p> <p>How is <code>setImmediate()</code> different from <code>setTimeout(() =&gt; {}, 0)</code> (passing a 0ms timeout), and from <code>process.nextTick()</code>?</p> <p>A function passed to <code>process.nextTick()</code> is going to be executed on the <strong>current</strong> iteration of the event loop, after the current operation ends. This means it will always execute before <code>setTimeout</code> and <code>setImmediate</code>.</p> <p>A <code>setTimeout()</code> callback with a 0ms delay is very similar to <code>setImmediate()</code>. <a href="https://stackoverflow.com/questions/24117267/nodejs-settimeoutfn-0-vs-setimmediatefn#:~:text=setTimeout(%2C0)%20essentially%20means,the%20present%20queue%20get%20executed.&amp;text=setImmediate%20is%20similar%20in%20this,processed%2C%20it%20executes%20the%20callback." target="_blank" rel="noopener noreferrer">The execution order will depend on various factors<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, but they will be both run in the next iteration of the event loop.</p> <p><code>setImmediate</code> callbacks are called after I/O Queue callbacks are finished or timed out. setImmediate callbacks are placed in Check Queue, which are processed after I/O Queue.</p> <p><code>setTimeout(fn, 0)</code> callbacks are placed in Timer Queue and will be called after I/O callbacks as well as Check Queue callbacks. As event loop, process the timer queue first in each iteration, so which one will be executed first depends on which phase event loop is.</p> <h2 id="event-loop"><a href="#event-loop" class="header-anchor">#</a> Event Loop</h2> <p>Event loop handles all async callbacks, starting from timers to close callbacks. There is also a <em>nextTickQueue</em> in the middle, however it’s not a part of the event loop itself. Each phase has a queue attached to it. When event loop enters in a particular phase, its target is to execute the callbacks/tasks in those queues.</p> <img src="data:image/png;base64,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"> <img src="/assets/img/event-loop2.ad344efc.png"> <table><thead><tr><th>Phase</th> <th>Description</th></tr></thead> <tbody><tr><td>Timer</td> <td>It handles the callbacks assigned by setTimeout &amp; setInterval after the given time threshold is completed.</td></tr> <tr><td>I/O callbacks</td> <td>Handles all callbacks except the ones set by setTimeout, setInterval &amp; setImmediate. It also does not have any close callbacks.</td></tr> <tr><td>Idle, prepare</td> <td>Used internally</td></tr> <tr><td>Pole</td> <td>Retrieve new I/O events. This is which makes node a cool dude.</td></tr> <tr><td>Check</td> <td>Here the callbacks of setImmediate() is handled.</td></tr> <tr><td>Close callbacks</td> <td>Handles close connection callbacks etc. (eg: socket connection close)</td></tr> <tr><td>nextTickQueue</td> <td>Holds the callbacks of process.nextTick(); but not a part of the event loop.</td></tr></tbody></table> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <p>[1] <a href="https://www.voidcanvas.com/setimmediate-vs-nexttick-vs-settimeout/" target="_blank" rel="noopener noreferrer">setImmediate() vs nextTick() vs setTimeout(fn,0) - in depth explanation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[2] <a href="https://flaviocopes.com/node-setimmediate/" target="_blank" rel="noopener noreferrer">Understanding setImmediate()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frontend/node/koa.html" class="prev">
        koa
      </a></span> <span class="next"><a href="/frontend/other/mysql.html">
        MySQL
      </a>
      →
    </span></p></div> <img src="/assets/img/bottom-logo.385a53c5.png" style="position:absolute;width:135px;left:calc(100% / 2 + 50px);transform:translateX(-50%);"></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a558ac5a.js" defer></script><script src="/assets/js/10.58d1b88a.js" defer></script><script src="/assets/js/2.7fe25666.js" defer></script><script src="/assets/js/1.8980b9bc.js" defer></script><script src="/assets/js/48.5d192a8f.js" defer></script>
  </body>
</html>
