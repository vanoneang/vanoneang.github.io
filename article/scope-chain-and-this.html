<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scope Chain and this | Evan&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/logo.png">
    <script src="https://www.googletagmanager.com/gtag/js?id=G-PHEXM93QFE" async="true"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
      
        gtag('config', 'G-PHEXM93QFE');
      </script>
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.41f50347.css" as="style"><link rel="preload" href="/assets/js/app.a558ac5a.js" as="script"><link rel="preload" href="/assets/js/10.58d1b88a.js" as="script"><link rel="preload" href="/assets/js/2.7fe25666.js" as="script"><link rel="preload" href="/assets/js/1.8980b9bc.js" as="script"><link rel="preload" href="/assets/js/32.fb2a7e01.js" as="script"><link rel="prefetch" href="/assets/js/11.7480e672.js"><link rel="prefetch" href="/assets/js/14.77e4d103.js"><link rel="prefetch" href="/assets/js/15.767347da.js"><link rel="prefetch" href="/assets/js/16.75837ee9.js"><link rel="prefetch" href="/assets/js/17.8b42675a.js"><link rel="prefetch" href="/assets/js/18.83de754f.js"><link rel="prefetch" href="/assets/js/19.64c1babe.js"><link rel="prefetch" href="/assets/js/20.eb3c9bfd.js"><link rel="prefetch" href="/assets/js/21.0ac73fe5.js"><link rel="prefetch" href="/assets/js/22.440e982a.js"><link rel="prefetch" href="/assets/js/23.14b7ea1e.js"><link rel="prefetch" href="/assets/js/24.2cc19a77.js"><link rel="prefetch" href="/assets/js/25.5a1af9bd.js"><link rel="prefetch" href="/assets/js/26.1dbf73a6.js"><link rel="prefetch" href="/assets/js/27.f35d0d7a.js"><link rel="prefetch" href="/assets/js/28.d3b1bd05.js"><link rel="prefetch" href="/assets/js/29.156c7c28.js"><link rel="prefetch" href="/assets/js/3.b2e8d6d0.js"><link rel="prefetch" href="/assets/js/30.d0ef52da.js"><link rel="prefetch" href="/assets/js/31.3141c712.js"><link rel="prefetch" href="/assets/js/33.60948b59.js"><link rel="prefetch" href="/assets/js/34.f7619399.js"><link rel="prefetch" href="/assets/js/35.6490ea95.js"><link rel="prefetch" href="/assets/js/36.a2c30aa4.js"><link rel="prefetch" href="/assets/js/37.4c4f8de0.js"><link rel="prefetch" href="/assets/js/38.1230e082.js"><link rel="prefetch" href="/assets/js/39.618e2b6e.js"><link rel="prefetch" href="/assets/js/4.7883f2b1.js"><link rel="prefetch" href="/assets/js/40.bc7d5fd1.js"><link rel="prefetch" href="/assets/js/41.f9f2f594.js"><link rel="prefetch" href="/assets/js/42.7a8c93b6.js"><link rel="prefetch" href="/assets/js/43.ff58b174.js"><link rel="prefetch" href="/assets/js/44.4cb3b30c.js"><link rel="prefetch" href="/assets/js/45.f15b11c7.js"><link rel="prefetch" href="/assets/js/46.80e4a51b.js"><link rel="prefetch" href="/assets/js/47.5ca31691.js"><link rel="prefetch" href="/assets/js/48.5d192a8f.js"><link rel="prefetch" href="/assets/js/49.52310326.js"><link rel="prefetch" href="/assets/js/5.180fde47.js"><link rel="prefetch" href="/assets/js/50.82d6e2db.js"><link rel="prefetch" href="/assets/js/51.d0bb03e0.js"><link rel="prefetch" href="/assets/js/52.bf0b3ca2.js"><link rel="prefetch" href="/assets/js/53.26741547.js"><link rel="prefetch" href="/assets/js/54.4d74c40c.js"><link rel="prefetch" href="/assets/js/55.2cc4e873.js"><link rel="prefetch" href="/assets/js/56.bb2e229a.js"><link rel="prefetch" href="/assets/js/57.52f6ff68.js"><link rel="prefetch" href="/assets/js/58.76d668cd.js"><link rel="prefetch" href="/assets/js/59.b03dda21.js"><link rel="prefetch" href="/assets/js/6.df748d3e.js"><link rel="prefetch" href="/assets/js/60.099a8d24.js"><link rel="prefetch" href="/assets/js/61.d3ea715f.js"><link rel="prefetch" href="/assets/js/62.56b719bf.js"><link rel="prefetch" href="/assets/js/63.5c213900.js"><link rel="prefetch" href="/assets/js/64.47676a52.js"><link rel="prefetch" href="/assets/js/65.e609f20c.js"><link rel="prefetch" href="/assets/js/66.6acc82e5.js"><link rel="prefetch" href="/assets/js/67.faf9a8ab.js"><link rel="prefetch" href="/assets/js/68.17c0704e.js"><link rel="prefetch" href="/assets/js/69.cd839ad6.js"><link rel="prefetch" href="/assets/js/7.d03bf257.js"><link rel="prefetch" href="/assets/js/70.f6ce40f5.js"><link rel="prefetch" href="/assets/js/71.f016426d.js"><link rel="prefetch" href="/assets/js/72.83b722de.js"><link rel="prefetch" href="/assets/js/73.4adccae9.js"><link rel="prefetch" href="/assets/js/74.1adc8aa0.js"><link rel="prefetch" href="/assets/js/75.e46164a6.js"><link rel="prefetch" href="/assets/js/76.8b5875a4.js"><link rel="prefetch" href="/assets/js/77.92eae67e.js"><link rel="prefetch" href="/assets/js/78.4cb6e049.js"><link rel="prefetch" href="/assets/js/79.03859c97.js"><link rel="prefetch" href="/assets/js/8.ecffb889.js"><link rel="prefetch" href="/assets/js/80.1288e8f0.js"><link rel="prefetch" href="/assets/js/81.d8841b36.js"><link rel="prefetch" href="/assets/js/82.e50feb3f.js"><link rel="prefetch" href="/assets/js/83.4553329a.js"><link rel="prefetch" href="/assets/js/84.faca13fe.js"><link rel="prefetch" href="/assets/js/85.cda6f0d0.js"><link rel="prefetch" href="/assets/js/86.4b93d23e.js"><link rel="prefetch" href="/assets/js/87.84ce55e8.js"><link rel="prefetch" href="/assets/js/88.651a4fd5.js"><link rel="prefetch" href="/assets/js/89.e8aa0f21.js"><link rel="prefetch" href="/assets/js/9.7babaa2e.js"><link rel="prefetch" href="/assets/js/90.d189b2da.js"><link rel="prefetch" href="/assets/js/91.befac5d7.js"><link rel="prefetch" href="/assets/js/92.3825ad82.js"><link rel="prefetch" href="/assets/js/93.b229e59f.js"><link rel="prefetch" href="/assets/js/94.703fe491.js"><link rel="prefetch" href="/assets/js/95.299fd1b4.js"><link rel="prefetch" href="/assets/js/96.dd1e2aab.js"><link rel="prefetch" href="/assets/js/97.b0c53a50.js"><link rel="prefetch" href="/assets/js/98.9eed6020.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.719578e8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.41f50347.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/left-logo.png" alt="Evan's Blog" class="logo"> <span class="site-name can-hide">Evan's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/frontend/" class="nav-link">
  大前端
</a></div><div class="nav-item"><a href="/devops/" class="nav-link">
  运维
</a></div><div class="nav-item"><a href="/article/" class="nav-link router-link-active">
  Article
</a></div><div class="nav-item"><a href="/english/" class="nav-link">
  English learning
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/vanoneang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/frontend/" class="nav-link">
  大前端
</a></div><div class="nav-item"><a href="/devops/" class="nav-link">
  运维
</a></div><div class="nav-item"><a href="/article/" class="nav-link router-link-active">
  Article
</a></div><div class="nav-item"><a href="/english/" class="nav-link">
  English learning
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/vanoneang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Software Engineer</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/article/clean-code.html" class="sidebar-link">Clean Code</a></li><li><a href="/article/dealing-with-legacy-code-and-technical-debt.html" class="sidebar-link">Dealing with Legacy Code and Technical Debt</a></li><li><a href="/article/secure-coding.html" class="sidebar-link">Secure Coding</a></li><li><a href="/article/microservices-vs-monolith.html" class="sidebar-link">Micro-services vs monolithic architecture</a></li><li><a href="/article/scope-chain-and-this.html" aria-current="page" class="active sidebar-link">Scope Chain and this</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/scope-chain-and-this.html#scope-chain" class="sidebar-link">scope chain</a></li><li class="sidebar-sub-header"><a href="/article/scope-chain-and-this.html#lexical-scope" class="sidebar-link">lexical scope</a></li><li class="sidebar-sub-header"><a href="/article/scope-chain-and-this.html#this" class="sidebar-link">this</a></li><li class="sidebar-sub-header"><a href="/article/scope-chain-and-this.html#summarize" class="sidebar-link">Summarize</a></li></ul></li><li><a href="/article/design-patterns.html" class="sidebar-link">Design Patterns</a></li><li><a href="/article/critical-rending-path.html" class="sidebar-link">Critical Rending Path</a></li><li><a href="/article/performance.html" class="sidebar-link">Performance</a></li><li><a href="/article/closure.html" class="sidebar-link">Closure</a></li><li><a href="/article/solid-design-principles.html" class="sidebar-link">S.O.L.I.D.</a></li><li><a href="/article/json-stringify.html" class="sidebar-link">JSON.stringify()</a></li><li><a href="/article/v-model-in-vue3.html" class="sidebar-link">V-Model in Vue3</a></li><li><a href="/article/time-management.html" class="sidebar-link">Time Management</a></li><li><a href="/article/event-loop.html" class="sidebar-link">Event Loop</a></li><li><a href="/article/engineering-excellence.html" class="sidebar-link">Engineering Excellence</a></li><li><a href="/article/the-evolution-of-web-site-building-technology-stack.html" class="sidebar-link">SSR.SSG.ISR.DPR</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Economics</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="scope-chain-and-this"><a href="#scope-chain-and-this" class="header-anchor">#</a> Scope Chain and this</h1> <p>JavaScript scope refers to the range of variables that can be accessed. There are three types Global scope, Function scope and Block scope.</p> <p>A piece of JavaScript code needs to be compiled by the JavaScript engine before it is executed. After the compilation is completed, it will enter the execution phase.</p> <img src="/assets/img/javascript-execution-process.adf5e9ad.jpg"> <p>On the basis of these, let's talk about what a scope chain is today.</p> <h2 id="scope-chain"><a href="#scope-chain" class="header-anchor">#</a> scope chain</h2> <p>First let's look at the following code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>scope<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;function&quot;</span>
    <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;global&quot;</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>What do you think the bar function and foo function print out in this code? This will analyze the execution flow of these two pieces of code.</p> <p>Regarding scope chaining, many people will find it confusing, but if you understand the concepts of <strong>call stack, execution context, lexical environment, variable environment</strong>, etc., then you will understand the scope chain very easily.</p> <p>In fact, in the variable environment of each execution context, an external reference is included to point to the external execution context. We call this external reference <strong>outer</strong> .</p> <p>For example, when the above code is looking for the <code>scope</code> variable, if it is not found in the current variable environment, the JavaScript engine will continue to search in the execution context pointed to by outer. We call this chain of lookups the <strong>scope chain</strong>.</p> <p>Now you know that variables are searched through the scope chain, but there is still a question that has not been solved, the bar function called by the foo function, then why the external reference of the bar function is the global execution context, not the execution context of the foo function?</p> <p>To answer this question, you also need to know what lexical scope is . This is because during JavaScript execution, its scope chain is determined by <strong>lexical scoping</strong>.</p> <h2 id="lexical-scope"><a href="#lexical-scope" class="header-anchor">#</a> lexical scope</h2> <p><strong>Lexical scope means that the scope is determined by the position of the function declaration in the code, so the lexical scope is a static scope, which can predict how the code looks for the identifier during the execution process.</strong></p> <p>This may not be easy to understand, let's look at the following picture:</p> <img src="/assets/img/lexical-code.c05fad01.png"> <p>Because the JavaScript scope chain is determined by the lexical scope, the entire order of the lexical scope chain is: foo function scope -&gt; bar function scope -&gt; main function scope -&gt; global scope.</p> <p>That is to say, the <strong>lexical scope is determined at the compilation stage of the code, and has nothing to do with how the function is called</strong>.</p> <p>All in all, the scope chain of the JavaScript language is determined by lexical scoping, which is determined by <strong>code structure( or position)</strong>.</p> <h2 id="this"><a href="#this" class="header-anchor">#</a> this</h2> <p>We need to distinguish the <strong>scope chain</strong> and <strong>this</strong> are two different systems, and there is not much connection between them.</p> <img src="/assets/img/execution-context.783cc88c.png"> <p>As can be seen from the figure, <code>this</code> is bound to the execution context , that is to say, there is a <code>this</code> <strong>in each execution context</strong>.</p> <p>The execution context is mainly divided into three types - the global execution context, the function execution context and the eval execution context, so the corresponding <code>this</code> is only these three - <strong><code>this</code> in the global execution context, <code>this</code> in the function execution context and <s><code>this</code> in eval execution context</s></strong>.</p> <h3 id="this-in-the-global-execution-context"><a href="#this-in-the-global-execution-context" class="header-anchor">#</a> <code>this</code> in the global execution context</h3> <p>You can type <code>console.log(this)</code> in the console to print out this in the global execution context, and the final output is the <code>window object</code>. So we can come to the conclusion that <code>this</code> in the global execution context refers to the window object. <strong>This is also the only point of intersection between <code>this</code> and the <code>scope chain</code>.</strong></p> <h3 id="this-in-the-function-execution-context"><a href="#this-in-the-function-execution-context" class="header-anchor">#</a> <code>this</code> in the function execution context</h3> <p>Let's look at the following code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>We print out the <code>this</code> value inside the foo function, execute this code, and the window object is also printed out, which means that <strong>when a function is called by default</strong>, the this in its execution context also points to the <strong>window object</strong>.</p> <p>Can we set this in the execution context to point to <strong>other objects</strong>? The answer is yes. In general, there are three ways to set the this value in the function execution context.</p> <p><strong>1. Set by call method of the function</strong></p> <img src="/assets/img/function.ad73a1e1.jpg"> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> protagonist <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">'Sherlock'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">'Holmes'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getFullName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">story</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">interest<span class="token punctuation">,</span> hobby</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' loves '</span> <span class="token operator">+</span> interest <span class="token operator">+</span> <span class="token string">' and '</span> <span class="token operator">+</span> hobby<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">story</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>protagonist<span class="token punctuation">,</span> <span class="token string">'reasoning'</span><span class="token punctuation">,</span> <span class="token string">'algorithm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// story.apply(protagonist,['reasoning', 'algorithm']); </span>

<span class="token comment">// const tellStory = story.bind(protagonist)</span>
<span class="token comment">// tellStory('reasoning', 'algorithm')</span>
</code></pre></div><p>The <code>call()</code> method calls a function with a given <code>this</code> value and arguments provided individually.</p> <p><strong>2. Set the method by calling the object</strong></p> <p>To change the this pointer in the function execution context, in addition to the call method of the function, we can also call it through the object, such as the following code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> protagonist <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">'Sherlock'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">'Holmes'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getFullName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
protagonist<span class="token punctuation">.</span><span class="token function">getFullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>So, we can come to the conclusion: use the object to call a method inside it, and the this of the method points to the object itself.</p> <p>Let's do a little change:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> protagonist <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">'Sherlock'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">'Holmes'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getFullName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fn <span class="token operator">=</span> protagonist<span class="token punctuation">.</span>getFullName
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Execute this code, we will find that <code>this</code> again points to the global window object.</p> <p>So by comparing the above two examples, we can draw the following two conclusions:</p> <ul><li>When calling a function in the global environment, the <code>this</code> inside the function points to the global variable window.</li> <li>Calling a method inside of an object whose this in the execution context of the method points to the object itself.</li></ul> <ol start="3"><li>Set by the constructor</li></ol> <p>We can set <code>this</code> in the constructor like this, as in the sample code below:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">CreateObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;E&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CreateObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>In fact, when executing <code>new CreateObj()</code>, the JavaScript engine does the following four things:</p> <ul><li>First create an empty object <code>instance</code>;</li> <li>Then call the <code>CreateObj.call</code> method and use <code>instance</code> as the parameter of the call method, so that when the execution context of <code>CreateObj</code> is created, its this points to the <code>instance</code> object;</li> <li><strong>Then execute the <code>CreateObj</code> function</strong>. At this time, the <code>this</code> in the execution context of the <code>CreateObj</code> function points to the <code>instance</code> object;</li> <li>Finally, the <code>instance</code> object is returned.</li></ul> <p>For better understanding, we can use code to demonstrate:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token function">CreateObj</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span>
<span class="token keyword">return</span> instance
</code></pre></div><p>In this way, we have constructed a new object through the <code>new</code> keyword, and <code>this</code> in the constructor is actually the new object itself.</p> <h2 id="summarize"><a href="#summarize" class="header-anchor">#</a> Summarize</h2> <p>The <strong>scope chain</strong> and <strong>this</strong> are two different systems, and there is not much connection between them. The only intersection between this and the scope chain is that, in some cases, they both point to the window object.</p> <p>The scope chain is determined by lexical scoping, which is determined by code structure( or position). But <code>this</code> is bound to the execution context.</p> <p>If you feel that <code>this</code> of some cases is not easy to identify, We can use <code>const self = this</code> to <strong>convert <code>this</code> system into a scope system</strong>.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/article/microservices-vs-monolith.html" class="prev">
        Micro-services vs monolithic architecture
      </a></span> <span class="next"><a href="/article/design-patterns.html">
        Design Patterns
      </a>
      →
    </span></p></div> <img src="/assets/img/bottom-logo.385a53c5.png" style="position:absolute;width:135px;left:calc(100% / 2 + 50px);transform:translateX(-50%);"></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a558ac5a.js" defer></script><script src="/assets/js/10.58d1b88a.js" defer></script><script src="/assets/js/2.7fe25666.js" defer></script><script src="/assets/js/1.8980b9bc.js" defer></script><script src="/assets/js/32.fb2a7e01.js" defer></script>
  </body>
</html>
